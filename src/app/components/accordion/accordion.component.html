<cdk-accordion class="example-accordion">
    <cdk-accordion-item
        #accordionItem="cdkAccordionItem"
        *ngFor="let element of accordionElems; let index = index"
        class="example-accordion-item"
        role="button"
        tabindex="0"
        [attr.id]="'accordion-header-' + index"
        [attr.aria-expanded]="accordionItem.expanded"
    >
        <div class="example-accordion-item-header" (click)="accordionItem.toggle()">
            <span *ngIf="!accordionItem.expanded">
                {{ element.nameStatic | titlecase }}
            </span>
            <span *ngIf="accordionItem.expanded">
                {{ (element.nameExpanded ? element.nameExpanded : element.nameStatic) | titlecase }}
            </span>
            <span class="example-accordion-item-description">
                {{ accordionItem.expanded ? 'close' : 'open' }}
            </span>
        </div>
        <div
            class="example-accordion-item-body"
            [attr.id]="'accordion-body-' + index"
            [style.display]="accordionItem.expanded ? '' : 'none'"
        >
            <form
                #form
                [attr.id]="element.node"
                [formGroup]="dictionary[element.node].formGroup"
                (ngSubmit)="onSubmit(form.id)"
            >
                <ng-container
                    *ngFor="let field of dictionary[element.node].formFields; let first = first"
                >
                    <mat-form-field
                        *ngIf="field.type === 'input'"
                        [ngClass]="{
                            'example-full-width': selectedFieldName !== 'input' && first,
                            'example-half-width': selectedFieldName === 'input' || !first
                        }"
                    >
                        <mat-label>{{ field.fieldName | normalizeCase }}
                        </mat-label>
                        <input
                            matInput
                            [formControlName]="field.propertyName"
                        />
                    </mat-form-field>
                    <mat-form-field
                        *ngIf="(selectedFieldName === 'input' || selectedFieldName === 'textarea') && field.fieldName === 'placeholder'"
                        class="example-half-width"
                    >
                        <mat-label>{{ field.fieldName | normalizeCase }}
                        </mat-label>
                        <input
                            matInput
                            [attr.placeholder]="field.propertyName"
                            [formControlName]="field.propertyName"
                        />
                    </mat-form-field>
                    <mat-form-field
                        *ngIf="field.type === 'select'"
                        [ngClass]="{
                            'example-full-width': first,
                            'example-half-width': !first
                        }"
                        appearance="fill"
                    >
                        <mat-select
                            [formControlName]="field.propertyName"
                            [value]="field.propertyName"
                        >
                            <mat-label>{{ field.propertyName }}</mat-label>
                            <mat-option
                                *ngFor="let option of fieldsMetaData[element.node].options[field.propertyName]"
                                [value]="option"
                            >
                                {{ option }}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-checkbox
                        *ngIf="field.type === 'checkbox'"
                        [formControlName]="field.propertyName"
                        color="primary"
                    >
                        Required field
                    </mat-checkbox>
                </ng-container>
                <div class="buttons-wrapper">
                    <button
                        type="submit"
                        class="button"
                        [attr.disabled]="element.node === fieldNode ? shouldDisableButtons : null"
                    >
                            Apply
                    </button>
                    <button
                        type="button"
                        class="button"
                        [attr.disabled]="element.node === fieldNode ? shouldDisableButtons : null"
                        (click)="reset(element.node)"
                    >
                        Delete
                    </button>
                </div>
            </form>
        </div>
    </cdk-accordion-item>
</cdk-accordion>